<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html lang="es">

<head>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    showMathMenu: false,
    "HTML-CSS": {
      availableFonts: ["STIX"],
      preferredFont: "STIX",
      webFont: "STIX-Web",
      matchFontHeight: false,
      mtextFontInherit: true
    },
    tex2jax: {
      inlineMath: [ ['$','$'] ]
    },
    TeX: {
			extensions: ["enclose.js"]
		},
    "fast-preview": {
      disabled: true
    }
  });
</script>
<script type="text/javascript" async
	src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_HTML">
</script>
<meta http-equiv="Content-Language" content="es">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Derivación e integración numéricas">
<meta name="keywords" content="derivación, integración, numéricas">
<title>Derivación e integración numéricas</title>
<link href="../estilo.css" rel="stylesheet" type="text/css">
<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-102174465-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!-- End Google Analytics -->
</head>

<body>

<div id="title">

<h3>Derivación e integración numéricas</h3>

<ul>
	<li><a href="../introduccion_estadistica_calculo_numerico.html">Temario</a></li>
	<li><a href="../../index.htm">Inicio</a></li>
</ul>

</div>

<div id="content">
	
<p>Se trata de derivar o integrar a partir de puntos, de unos datos.</p>

<p><b>1.</b> Derivación numérica:</p>

	<p style="display:table;margin-left:30px">
		<span style="display:table-row">
			<span style="display:table-cell">
				<object data="derivacion_integracion_numericas_01.svg"
				type="image/svg+xml" width="400" height="270"></object>
			</span>
			<span style="display:table-cell;vertical-align:middle">
				$\dfrac{f(x_0 + h) - f(x_0)}{h} = \tan \alpha$</span>
		</span>
	</p>
	
<p>La definición de derivada:</p>

	<p style="text-align:center">
		$f'(x_0) = \lim\limits_{h \to 0} \dfrac{f(x_0+h) - f(x_0)}{h}$</p>
		
<p>Por tanto:</p>

	<p style="text-align:center">
		$\boxed{\,f'(x_0) \cong \dfrac{f(x_0+h)-f(x_0)}{h} \,\text{ si }\, h
		\cong 0}$</p>
		
<p>Así, con esta última expresión, se pueden obtener valores aproximados
a la derivada si la $h$ es suficientemente pequeña.</p>

<p>La fórmula de Taylor para $x$ entorno a $x_0$:</p>

	<p style="text-align:center">
		$
		\begin{align}
			f(x) &amp;= f(x_0) + (x-x_0) \mspace{2mu} f'(x_0) +
			\dfrac{(x-x_0)^2}{2} f''(x_0) + \dfrac{(x-x_0)^3}{6}f'''(x_0) +
			\dotsb + \\[1ex]
			&amp;{\hphantom{={}}} + \dfrac{(x-x_0)^n}{n!} f^{(n)}(x_0) +
			\dfrac{(x-x_0)^{n+1}}{(n+1)!} f^{(n+1)}(\xi(x))\,, \quad \xi(x) \in
			(x,x_0)
		\end{align}
		$
	</p>
	
<p>Entonces, si $x_1 = x_0 + h$, y además $f(x_0)$, $\, f(x_1)$ son
conocidos:</p>

	<p style="text-align:center">
		$f(x_1) = f(x_0 + h) = f(x_0) + h f'(x_0) + \dfrac{1}{2} h^2 f''(\xi)
		\,, \quad \xi \in (x_0,x_1)$</p>
		
<p>Por tanto:</p>

	<p style="text-align:center">
		$f'(x_0) = \dfrac{f(x_0+h)-f(x_0)}{h} - \dfrac{1}{2} h f''(\xi) \,,
		\quad \xi \in (x_0,x_1)$</p>
		
<p>Así pues, si, como se vio más arriba, se usa el primer término
del lado derecho de esta última igualdad para aproximar la primera
derivada en $x_0$, el error que se comete es proporcional a $h$.</p>

<p>Con tres puntos equidistantes:</p>

<center>
	<object data="derivacion_integracion_numericas_02.svg" type="image/svg+xml"
	width="400" height="270"></object>
</center>

<p>Siendo:</p>

	<p style="text-align:center">
		$
		\left.
		\begin{array}{l}
			\enclose{circle}{\mspace{2mu}1\mspace{2mu}} \enspace
			f'(x_0) \approx \dfrac{f(x_0 + h) - f(x_0)}{h} \\[1ex]
			\enclose{circle}{\mspace{2mu}2\mspace{2mu}} \enspace
			f'(x_0) \approx \dfrac{f(x_0) - f(x_0 - h)}{h}
		\end{array}
		\right\}
		$ error $\propto h$
	</p>
	
<p>También:</p>

	<p style="text-align:center">
		$
		\left.
		\dfrac{
			\enclose{circle}{\mspace{2mu}1\mspace{2mu}} +
			\enclose{circle}{\mspace{2mu}2\mspace{2mu}}
		}{2} \equiv \enclose{circle}{\mspace{2mu}3\mspace{2mu}} \enspace
		f'(x_0) \approx \dfrac{f(x_0 + h) - f(x_0 - h)}{2h}
		\right\}
		$ error $\propto h^2$
	</p>
	
<p>Si $h$ es muy pequeña ésta última aproximación de $f'(x_0)$ es mejor 
que las otras dos. El error señalado para ella se justifica partiendo de 
los desarrollos de Taylor de los puntos anterior y posterior:</p>

	<p style="text-align:center">
		$
		\begin{array}{l}
			f(x_0 + h) = f(x_0) + h f'(x_0) + \dfrac{1}{2} h^2 f''(x_0) +
			\dfrac{1}{6} h^3 f'''(\xi)\,, \quad \xi \in (x_0,x_0+h) \\[1ex]
			f(x_0 - h) = f(x_0) - h f'(x_0) + \dfrac{1}{2} h^2 f''(x_0) -
			\dfrac{1}{6} h^3 f'''(\eta)\,, \quad \eta \in (x_0-h,x_0)
		\end{array}
		$
	</p>
	
<p>Restando:</p>

	<p style="text-align:center">
		$f(x_0 + h) - f(x_0 - h) = 2h f'(x_0) + \dfrac{1}{6} h^3 (\,f'''(\xi)
		+ f'''(\eta))$</p>
		
<p>Por tanto:</p>

	<p style="text-align:center">
		$
		\begin{array}{c}
			f'(x_0) = \dfrac{f(x_0 + h) - f(x_0 - h)}{2h} - \dfrac{1}{12} h^2
			(\,f'''(\xi) + f'''(\eta))\,, \\[1ex]
			\xi \in (x_0,x_0 + h), \eta \in (x_0 - h,x_0)
		\end{array}
		$</p>
		
<p>Por lo que si se utiliza el primer término de la derecha para
aproximar el valor de la primera derivada en $x_0$ el error que se
comete es proporcional a $h^2$.</p>

<hr>

<div id="ejemplo">
	
<p>Ejemplo:</p>

<p>El punto de congelación, en grados centigrados, de la mezcla 
glicerina-agua en tanto por ciento en peso de la primera:</p>

<span style="display:table;margin-left:auto;margin-right:auto">
	<span style="display:table-row">
		<span style="display:table-cell;padding-right:2em">
			<table class="tabla ejemplo" style="text-align:center">
				<tr>
					<th>$x$</th>
					<th>$y$</th>
				</tr>
				<tr>
					<td>20</td>
					<td>−4,8</td>
				</tr>
				<tr>
					<td>30</td>
					<td>−9,5</td>
				</tr>
				<tr>
					<td>40</td>
					<td>−15,4</td>
				</tr>
			</table>
		</span>
		<span style="display:table-cell;vertical-align:middle">
			$
			\begin{array}{l}
				f'(30) \approx \dfrac{-15{,}4 + 9{,}5}{40 - 30} = -0{,}59 \\[1ex]
				f'(30) \approx \dfrac{-15{,}4 + 4{,}8}{40 - 20} = -0{,}53
			\end{array}
			$
		</span>
	</span>
</span>
	
</div>

<hr>

<div id="ejemplo">
	
<p>Ejemplo:</p>

<p>Para:</p>

	<p style="text-align:center">
		$f(x) = \tan (x)$</p>
		
<p>Determinar diferentes valores aproximados de $f'(1)$, y compararlo
con el exacto:</p>

	<p style="text-align:center">
		$f'(1) = \dfrac{1}{\cos^2 1} = 3{,}4255$</p>
		
<p>Para $h = 0{,}1\,$:</p>

	<p style="text-align:center">
		$
		\begin{array}{l}
			(1) \enspace f'(1) \approx \dfrac{f(1{,}1)-f(1)}{0{,}1} =
			\dfrac{\tan 1{,}1 - \tan 1}{0{,}1} = 4{,}0735 \\[1ex]
			(2) \enspace f'(1) \approx \dfrac{f(1)-f(0{,}9)}{0{,}1} =
			\dfrac{\tan 1 - \tan 0{,}9}{0{,}1} = 2{,}9725 \\[1ex]
			\llap{\rightarrow {}} (3) \enspace f'(1) \approx \dfrac{f(1{,}1) -
			f(0{,}9)}{2 \cdot 0{,}1} = \dfrac{\tan 1{,}1 - \tan 0{,}9}{0{,}2}
			= 3{,}5230
		\end{array}
		$
	</p>
	
<p>Para $h = 0{,}05\,$:</p>

	<p style="text-align:center">
		$
		\begin{array}{l}
			(1) \enspace f'(1) \approx \dfrac{\tan 1{,}05 - \tan 1}{0{,}05}	=
			3{,}7182 \\[1ex]
			(2) \enspace f'(1) \approx \dfrac{\tan 1 - \tan 0{,}95}{0{,}05} = 
			3{,}1805 \\[1ex]
			\llap{\rightarrow {}} (3) \enspace f'(1) \approx
			\dfrac{\tan 1{,}05 - \tan 0{,}95}{0{,}1} = 3{,}4493
		\end{array}
		$
	</p>
	
<p>Para $h = 0{,}02\,$:</p>

	<p style="text-align:center">
		$
		\begin{array}{l}
			(1) \enspace f'(1) \approx \dfrac{\tan 1{,}02 - \tan 1}{0{,}02}	=
			3{,}5361 \\[1ex]
			(2) \enspace f'(1) \approx \dfrac{\tan 1 - \tan 0{,}98}{0{,}02} = 
			3{,}3225 \\[1ex]
			\llap{\rightarrow {}} (3) \enspace f'(1) \approx
			\dfrac{\tan 1{,}02 - \tan 0{,}98}{0{,}04} = 3{,}4293
		\end{array}
		$
	</p>
	
<p>Al disminuir $h$, la separación entre los puntos, las aproximaciones 
mejoran, siendo, en particular, de las tres fórmulas, la tercera la que
siempre se acerca más al valor exacto.</p>
	
</div>
	
<hr>

<p><b>2.</b> Integración numérica:</p>

<p><b>&bull;</b> Métodos del rectángulo y del trapecio:</p>

<p>Puede aproximarse la integral, el área bajo la curva, como una
suma de rectángulos:</p>

	<p style="text-align:center">
		<object data="derivacion_integracion_numericas_03.svg" width="300"
		height="225" type="image/svg+xml"
		style="display:inline-block;vertical-align:middle"></object>
		$\displaystyle \int_a^b f(x) \, dx \approx$ Suma de áreas de
		rectángulos.
	</p>
	
<p>Ya sea que se use, para definir la altura de los rectángulos, el 
primer punto o el segundo de cada subintervalo, se produce, cuando la curva 
es creciente o decreciente, un error por defecto o por exceso en el 
cálculo del área. Sin embargo, si se usa el punto medio de cada 
subintervalo, para definir la altura del rectángulo correspondiente, el 
error se compensa en parte:</p>

<p style="display:table;margin-left:auto;margin-right:auto">
	<span style="display:table-row">
		<span style="display:table-cell;vertical-align:middle">
			<object data="derivacion_integracion_numericas_04.svg" width="300"
			height="225" type="image/svg+xml"></object>
		</span>
		<span style="display:table-cell;vertical-align:middle">
			<span style="display:table-cell;white-space:nowrap">
				Error =&nbsp;</span>
			<span style="display:table-cell">
				diferencia entre ambos trozos sombreados.</span>
		</span>
	</span>
</p>

<p>Así pues, en lo que se conoce como integrar por rectángulos:</p>

	<p style="text-align:center">
		$\displaystyle \int_a^b f(x) \, dx \approx \sum_{i = 1}^n (x_i - x_{i-1})
		\, f \! \left( \dfrac{x_{i-1} + x_i}{2} \right)$</p>
		
<p>Conforme $n$ crece la aproximación es mejor, por lo que cuando $n \to
\infty$ se hace exacta.</p>

<p>Si se unen dos puntos consecutivos con una línea recta, debajo
se tiene un trapecio:</p>

<center>
	<object data="derivacion_integracion_numericas_05.svg" width="300"
	height="225" type="image/svg+xml"></object>
</center>
	
<p>Puede entonces considerase que:</p>

	<p style="text-align:center">
		$\displaystyle \int_a^b f(x) \, dx \approx$ Suma de áreas de
		trapecios.</p>
		
<p>Siendo:</p>

	<p style="text-align:center">
		Área trapecio = $\dfrac{\text{Base 1} + \text{Base 2}}{2} \times
		\text{Altura}$</p>
		
<p>Por tanto:</p>

	<p style="text-align:center">
		$\displaystyle \int_a^b f(x) \, dx \approx \sum_{i=1}^n
		(x_i - x_{i-1}) \dfrac{f(x_{i-1}) + f(x_{i})}{2}$</p>
		
<p>Integrar por trapecios es la forma más común de integración
numérica.</p>

<hr>

<div id="ejemplo">
	
<p>Ejemplo:</p>

	<p style="text-align:center">
		$\displaystyle \int_0^1 \dfrac{dx}{1+x}$</p>
		
<p>Calcular esta integral por rectángulos y trapecios, dividiendo el
intervalo en cuatro trozos.</p>

<p>Primero, analíticamente:</p>

	<p style="text-align:center">
		$\displaystyle \int_0^1 \dfrac{dx}{1+x} = [\ln (1+x)]_0^1 = \ln 2 =
		0{,}6931$</p>
		
<p>Si, como se propone, se divide el intervalo en cuatro subintervalos:</p>

<center>
	<object data="derivacion_integracion_numericas_06.svg" width="200"
	height="50" type="image/svg+xml"></object>
</center>

<p>Si también:</p>

	<p style="text-align:center">
		$f(x) = \dfrac{1}{1+x}$</p>
		
<p>Entonces:</p>
	
<p>1) Por rectángulos:</p>

	<p style="text-align:center">
		$\displaystyle \int_0^1 \dfrac{dx}{1+x} \approx 0{,}25 (\,f(0{,}125)
		+ f(0{,}375) + f(0{,}625) + f(0{,}875)) = 0{,}6912$</p>
		
<p>2) Por trapecios:</p>

	<p style="text-align:center">
		$
		\begin{align}
			\int_0^1 \dfrac{dx}{1+x} &amp;\approx 0{,}25 \! \left(
			\dfrac{f(0)+f(0{,}25)}{2} + \dfrac{f(0{,}25)+f(0,5)}{2} +
			\dfrac{f(0{,}5)+f(0{,}75)}{2} + {} \right. \\[1ex]
			&amp;\hphantom{\approx} \left. {} + \dfrac{f(0{,}75)+f(1)}{2}
			\right) =	0{,}6970
		\end{align}
		$
	</p>

</div>

<hr>

<p><b>&bull;</b> Método de Simpson:</p>

<p>Se basa en unir los puntos con arcos. Esto es, si los dos puntos del 
subintervalo se unen mediante una parábola, que pasa por el punto 
intermedio, representada por un polinomio de segundo grado de 
Lagrange:</p>

	<p style="text-align:center">
		$
		\begin{align}
			\int_{x_{i-1}}^{x_i} f(x) \, dx &amp;\approx \int_{x_{i-1}}^{x_i}
			\, \biggl[ \, f(x_{i-1})
			\dfrac{
				(x-(x_{i-1}+x_i){∕}2)(x-x_i)
			}{
				(x_{i-1}-(x_{i-1}+x_i){∕}2)(x_{i-1}-x_i)
			} + {} \\[1ex]
			&amp;\hphantom{\approx \int_{x_{i-1}}^{x_i} \, \biggl[} {+\ } \,
			f\!\left(\dfrac{x_{i-1} + x_i}{2}\right)
			\dfrac{
				(x-x_{i-1})(x-x_i)
			}{
				((x_{i-1}+x_i){∕}2-x_{i-1})((x_{i-1}+x_i){∕}2-x_i)
			} + {} \\[1ex]
			&amp;\hphantom{\approx \int_{x_{i-1}}^{x_i} \, \biggl[} {+\ } \,
			f(x_i)
			\dfrac{
				(x-x_{i-1})(x-(x_{i-1}+x_i){∕}2)
			}{
				(x_i-x_{i-1})(x_i-(x_{i-1}+x_i){∕}2)
			} \biggr] \, dx = \\[1ex]
			&amp;= \, f(x_{i-1}) \int_{x_{i-1}}^{x_i}
			\dfrac{
				(x-(x_{i-1}+x_i){∕}2)(x-x_i)
			}{
				(x_{i-1}-(x_{i-1}+x_i){∕}2)(x_{i-1}-x_i)
			} \, dx + {} \\[1ex]
			&amp;\hphantom{={}} + \, f\!\left(\dfrac{x_{i-1} + x_i}{2}\right)
			\int_{x_{i-1}}^{x_i}
			\dfrac{
				(x-x_{i-1})(x-x_i)
			}{
				((x_{i-1}+x_i){∕}2-x_{i-1})((x_{i-1}+x_i){∕}2-x_i)
			} \, dx + {} \\[1ex]
			&amp;\hphantom{={}} + \, f(x_i) \int_{x_{i-1}}^{x_i}
			\dfrac{
				(x-x_{i-1})(x-(x_{i-1}+x_i){∕}2)
			}{
				(x_i-x_{i-1})(x_i-(x_{i-1}+x_i){∕}2)
			} \, dx
		\end{align}
		$
	</p>
	
<p>Si:</p>

	<p style="text-align:center">
		$x_i - x_{i-1} = 2h$</p>
		
<p>Entonces:</p>

	<p style="text-align:center">
		$\dfrac{x_{i-1} + x_i}{2} - x_{i-1} = x_i - \dfrac{x_{i-1}+x_i}{2}
		= h$</p>
		
<p>Siendo pues en el subintervalo:</p>

	<p style="text-align:center">
		$x = 2ht + x_{i-1} \quad 0 \leq t \leq 1$</p>
		
<p>Así que, por tanto:</p>

	<p style="text-align:center">
		$dx = \dfrac{dx}{dt} \, dt = 2h \, dt$</p>

<p>Por separado, sustituyendo en cada integral y, a continuación, 
integrando, empezando por la del primer término:</p>

	<p style="text-align:center">
		$
		\begin{array}{c}
			\displaystyle \int_{x_{i-1}}^{x_i}
			\dfrac{
				(x-(x_{i-1}+x_i){∕}2)(x-x_i)
			}{
				(\underbrace{x_{i-1}-(x_{i-1}+x_i){∕}2}_{-h})
				(\underbrace{x_{i-1}-x_i}_{-2h})
			} \, dx = \\[1ex]
			= \displaystyle \int_0^1
			\dfrac{
				(2ht + \overbrace{x_{i-1} - (x_{i-1} + x_i){∕}2}^{-h})
				(2ht + \overbrace{x_{i-1} - x_i}^{-2h})						
			}{2h^2} 2h \, dt = \\[1ex]
			= \displaystyle \int_0^1 \dfrac{(2ht-h)(2ht-2h)}{h}
			\, dt = \int_0^1 \dfrac{h (2t-1) 2h (t-1)}{h} \, dt = \\[1ex]
			= \displaystyle 2h \int_0^1 (2t-1)(t-1) \, dt = 2h \int_0^1
			(2t^2 - 3t + 1) \, dt = \\[1ex]
			= \displaystyle 2h \left[ \dfrac{2t^3}{3} - \dfrac{3t^2}{2} +
			t \right]_0^1 = 2h \left( \dfrac{2}{3} - \dfrac{3}{2} + 1 \right)
			=	\\[1ex]
			= \dfrac{2h}{6} = \dfrac{x_i - x_{i-1}}{6}
		\end{array}
		$
	</p>
	
<p>Segunda:</p>

	<p style="text-align:center">
		$
		\begin{array}{c}
			\displaystyle \int_{x_{i-1}}^{x_i}
			\dfrac{
				(x-x_{i-1})(x-x_i)
			}{
				(\underbrace{(x_{i-1}+x_i){∕}2-x_{i-1}}_h)
				(\underbrace{(x_{i-1}+x_i){∕}2-x_i}_{-h})
			} \, dx = \\[1ex]
			= \displaystyle \int_0^1
			\dfrac{
				(2ht + x_{i-1} - x_{i-1})(2ht + \overbrace{x_{i-1} - x_i}^{-2h})
			}{-h^2} 2h \, dt = \\[1ex]
			\displaystyle = 2 \int_0^1 \dfrac{2ht (2ht - 2h)}{-h} \, dt = 2
			\int_0^1 \dfrac{4h^2t(t-1)}{-h} \, dt = \\[1ex]
			\displaystyle = -8h \int_0^1 t(t-1) \, dt = -8h \int_0^1 (t^2 - t)
			\, dt = \\[1ex]
			= -8h \left[ \dfrac{t^3}{3} - \dfrac{t^2}{2} \right]_0^1 = -8h
			\left( \dfrac{1}{3} - \dfrac{1}{2} \right) = \\[1ex]
			= \dfrac{8h}{6} = \dfrac{4(x_i - x_{i-1})}{6}
		\end{array}
		$
	</p>
	
<p>Tercera:</p>

	<p style="text-align:center">
		$
		\begin{array}{c}
			\displaystyle \int_{x_{i-1}}^{x_i}
			\dfrac{
				(x-x_{i-1})(x-(x_{i-1}+x_i){∕}2)
			}{
				(\underbrace{x_i-x_{i-1}}_{2h})
				(\underbrace{x_i-(x_{i-1}+x_i){∕}2}_h)
			} \, dx = \\[1ex]
			\displaystyle = \int_0^1
			\dfrac{
				(2ht + x_{i-1} - x_{i-1})
				(2ht + \overbrace{x_{i-1} - (x_{i-1}+x_i){∕}2}^{-h})
			}{
				2h^2
			} 2h \, dt = \\[1ex]
			= \displaystyle \int_0^1 \dfrac{2ht(2ht - h)}{h} \, dt = 
			\int_0^1 \dfrac{2h^2t(2t-1)}{h} \, dt = \\[1ex]
			\displaystyle = 2h \int_0^1 t(2t-1) \,dt = 2h \int_0^1 (2t^2 - t)
			\, dt = \\[1ex]
			= 2h \left[ \dfrac{2t^3}{3} - \dfrac{t^2}{2} \right]_0^1 =
			2h \left( \dfrac{2}{3} - \dfrac{1}{2} \right) = \\[1ex]
			= \dfrac{2h}{6} = \dfrac{x_i - x_{i-1}}{6}
		\end{array}
		$
	</p>
	
<p>Por consiguiente, resulta que:</p>


	<p style="text-align:center">
		$
		\begin{align}
			\int_{x_{i-1}}^{x_i} f(x) \, dx &amp;\approx f(x_{i-1}) \dfrac{x_i
			-	x_{i-1}}{6} + f \! \left( \dfrac{x_{i-1} + x_i}{2} \right)
			\dfrac{4(x_i - x_{i-1})}{6} + f(x_i) \dfrac{x_i - x_{i-1}}{6} = \\[1ex]
			&amp;= (x_i - x_{i-1})
			\dfrac{
				f(x_{i-1}) + 4 f \! \left( \dfrac{x_{i-1} + x_i}{2} \right) +
				f(x_i)
			}{6}
		\end{align}
		$
	</p>
	
<p>Así pues para un intervalo, ya que su integral es la suma de las 
integrales de los subintervalos en los que está dividido:</p>

	<p style="text-align:center">
		$
		\displaystyle \int_a^b f(x) \, dx =
		\sum_{i=1}^n (x_i - x_{i-1})
			\dfrac{
				f(x_{i-1}) + 4 f \! \left( \dfrac{x_{i-1} + x_i}{2} \right) +
				f(x_i)
			}{6}
		$
	</p>
	
<hr>
	
<div id="ejemplo">
	
<p>Ejemplo:</p>

<p>De nuevo:</p>

	<p style="text-align:center">
		$\displaystyle \int_0^1 \dfrac{dx}{1+x}$</p>
		
<p>Con los mismos cuatro subintervalos, del mismo tamaño, que se 
establecieron, mediante la regla de Simpson:</p>

	<p style="text-align:center">
		$
		\begin{align}
			\int_0^1 \dfrac{dx}{1+x} &amp;\approx 0{,}25 \left(
			\dfrac{f(0) + 4f(0{,}125) + f(0{,}25)}{6} + 
			\dfrac{f(0{,}25) + 4f(0{,}375) + f(0{,}5)}{6} + {} \right. \\[1ex]
			&amp;\hphantom{\approx} \left. {} +
			\dfrac{f(0{,}5) + 4f(0{,}625) + f(0{,}75)}{6} +
			\dfrac{f(0{,}75) + 4f(0{,}875) + f(1)}{6} \right) = \\[1ex]
			&amp;= 0{,}6932
		\end{align}
		$
	</p>
	
</div>

<hr>

<div id="ejemplo">
	
<p>Ejemplo:</p>

<p>Sea:</p>

	<p style="text-align:center">
		$f(x) = e^{-x^2{∕}2}$</p>
		
<p>Cuya representación gráfica:</p>

	<p style="text-align:center">
		<object data="derivacion_integracion_numericas_07.svg" width="200"
		height="150" type="image/svg+xml"
		style="display:inline-block;background:white;border:1px solid black;vertical-align:middle;margin-right:1em">
		</object>
		Curva de Gauss o de campana.
	</p>
		
<p>Calcular:</p>

	<p style="text-align:center">
		$\displaystyle \int_{-2}^2 f(x) \, dx$</p>
		
<p>Como se observa de la representación, por la simetría:</p>

	<p style="text-align:center">
		$\displaystyle \int_{-2}^2 e^{-x^2{∕}2} \, dx =
		2 \int_0^2 e^{-x^2{∕}2} \, dx$</p>
	
<p>Ya que esta función no tiene antiderivada que permita usar la regla 
de Barrow para el cálculo de su integral definida, ésta debe llevarse a 
cabo por métodos numéricos. Dividiendo el intervalo en cuatro trozos de
igual longitud:</p>

<p>1) Trapecios:</p>

		<p style="text-align:center">
			$
			\begin{align}
				\int_0^2 e^{-x^2{∕}2} &amp;\approx 0{,}5 \left(
				\dfrac{f(0)+f(0{,}5)}{2} + \dfrac{f(0{,}5)+f(1)}{2} +
				\dfrac{f(1)+f(1{,}5)}{2} + {} \right. \\[1ex]
				&amp;\hphantom{\approx} \left. {} + \dfrac{f(1{,}5)+f(2)}{2}
				\right) = 1{,}191
			\end{align}
			$
		</p>
		
<p>Por tanto:</p>

	<p style="text-align:center">
		$\displaystyle \int_{-2}^2 e^{-x^2{∕}2} \, dx \approx 2 \cdot 1{,}191
		=	2{,}382$</p>
		
<p>2) Simpson:</p>

	<p style="text-align:center">
		$
		\begin{align}
			\int_0^2 e^{-x^2{∕}2} &amp;\approx 0{,}5 \left(
			\dfrac{f(0) + 4f(0{,}25) + f(0{,}5)}{6} +
			\dfrac{f(0{,}5) + 4f(0{,}75) + f(1)}{6} + {} \right. \\[1ex]
			&amp;\hphantom{\approx} \left. {} +
			\dfrac{f(1) + 4f(1{,}25) + f(1{,}5)}{6} + 
			\dfrac{f(1{,}5) + 4f(1{,}75) + f(2)}{6} \right) = \\[1ex]
			&amp;= 1{,}196
		\end{align}
		$
	</p>
	
<p>Por consiguiente:</p>

	<p style="text-align:center">
		$\displaystyle \int_{-2}^2 e^{-x^2{∕}2} \, dx \approx 2 \cdot 1{,}196
		= 2{,}392$</p>
		
<p>Si se hace el cálculo con la integración numérica de la calculadora
CASIO <i>fx-3900Pv</i>, que usa también el método de Simpson pero con un
número mucho mayor de subintervalos, el resultado que se obtiene es:</p>

	<p style="text-align:center">
		$\displaystyle \int_{-2}^2 e^{-x^2{∕}2} \, dx \approx 2{,}392576$</p>
	
</div>

<hr>

<p>Según el método que se utilice para calcular la integral será mejor 
la aproximación, la cual también dependerá de cómo sea la función.</p>

</div>

<div id="foot">
	
<a href="../introduccion_estadistica_calculo_numerico.html">Temario</a>

<ul>
	<li>
		<a href="../interpolacion_polinomial/interpolacion_polinomial.html"
		title="Anterior">&lt;</a>
	</li>
	<li>
		<a href="../resolucion_ecuaciones/resolucion_ecuaciones.html"
		title="Siguiente">&gt;</a>
	</li>
</ul>

</div>

</body>
</html>
